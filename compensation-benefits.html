<!-- Compensation & Benefits Dashboard - Employee Directory UI Style -->
<!-- Note: Audit log scripts are loaded in parent page (employeedirectory.html) -->
<script src="./departments-api.js"></script>
<script src="./government-contributions.js"></script>
<script src="./compensation-api.js"></script>
<script src="./compensation-benefits.js"></script>
<script>
  // Dynamically populate department filter from Airtable
  document.addEventListener('DOMContentLoaded', async function() {
    if (window.DepartmentsAPI?.populateDepartmentSelect) {
      const deptFilter = document.getElementById('compDepartmentFilter');
      if (deptFilter) {
        await window.DepartmentsAPI.populateDepartmentSelect(deptFilter);
      }
    }
  });
</script>

<!-- Dropdown styles for Actions menu -->
<style>
  .dropdown-content.show {
    display: block !important;
  }
  .dropdown-content a:hover {
    background: #275b48 !important;
  }
  /* Toggle Switch Styles */
  .toggle-switch {
    position: relative;
    display: inline-block;
    width: 40px;
    height: 22px;
  }
  .toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }
  .toggle-switch .slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #495057;
    transition: .3s;
    border-radius: 22px;
  }
  .toggle-switch .slider:before {
    position: absolute;
    content: "";
    height: 16px;
    width: 16px;
    left: 3px;
    bottom: 3px;
    background-color: white;
    transition: .3s;
    border-radius: 50%;
  }
  .toggle-switch input:checked + .slider {
    background-color: #28a745;
  }
  .toggle-switch input:checked + .slider:before {
    transform: translateX(18px);
  }
</style>
<script>
  // Close dropdowns when clicking outside
  document.addEventListener('click', function(e) {
    if (!e.target.matches('.dropdown button')) {
      document.querySelectorAll('.dropdown-content.show').forEach(function(dropdown) {
        dropdown.classList.remove('show');
      });
    }
  });
</script>

<!-- Floating loading overlay - matches Employee Directory -->
<div id="compLoadingIndicator" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); z-index:9999; justify-content:center; align-items:center;">
  <div style="background:#0d1b0e; padding:2rem 3rem; border-radius:8px; border:1px solid #275b48; text-align:center;">
    <div style="width:50px; height:50px; border:4px solid #275b48; border-top-color:#198754; border-radius:50%; animation:spin 1s linear infinite; margin:0 auto 1rem;"></div>
    <div style="color:#fff; font-size:1rem;">Loading payroll data...</div>
  </div>
</div>

<h2>Compensation & Benefits</h2>

<!-- Metrics: Totals -->
<div class="summary-bar metrics">
  <div class="summary-item">
    <h4>Total Monthly Salaries</h4>
    <div class="value" id="totalCompensation">--</div>
  </div>
  <div class="summary-item">
    <h4>Total Employees</h4>
    <div class="value" id="compEmployees">--</div>
  </div>
  <div class="summary-item">
    <h4>Average Salary</h4>
    <div class="value" id="avgBenefits">--</div>
  </div>
  <div class="summary-item">
    <h4>Total Allowances</h4>
    <div class="value" id="totalBonuses">--</div>
  </div>
</div>

<!-- Compensation & Benefits Card -->
<div class="card">
  <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:0.75rem;">
    <h3 style="margin:0;">Compensation & Benefits</h3>
    <div style="display:flex; gap:0.5rem;">
      <button type="button" class="btn-primary" style="background:linear-gradient(135deg, #6c757d 0%, #495057 100%);" onclick="AuditLogModal.open('Human Resources', 'Payrolls,PayrollItems')" title="View Audit Log">üìã Audit Log</button>
      <button type="button" class="btn-primary" style="background:linear-gradient(135deg, #0dcaf0 0%, #0aa2c0 100%);" onclick="window.refreshCompensationDirectory?.()" title="Refresh">üîÑ Refresh</button>
    </div>
  </div>
  <!-- Filters -->
  <div class="card" style="margin-bottom:0.75rem;">
    <div class="filters-grid filter-bar-grid">
      <label>Search by Name
        <input type="text" id="compNameFilter" placeholder="Search employees..." oninput="window.applyCompensationFilters?.()" />
      </label>
      <label>Department
        <select id="compDepartmentFilter" onchange="window.applyCompensationFilters?.()">
          <option value="">All Departments</option>
          <!-- Departments loaded dynamically from Airtable -->
        </select>
      </label>
      <label>Contract Status
        <select id="compContractFilter" onchange="window.applyCompensationFilters?.()">
          <option value="">All Contract Types</option>
          <option value="Full-time">Full-time</option>
          <option value="Part-time">Part-time</option>
          <option value="Contractor">Contractor</option>
          <option value="Intern">Intern</option>
        </select>
      </label>
      <label>Status
        <select id="compStatusFilter" onchange="window.applyCompensationFilters?.()">
          <option value="">All Statuses</option>
          <option value="Active">Active</option>
          <option value="Pending Approval">Pending Approval</option>
          <option value="On Leave">On Leave</option>
          <option value="Terminated">Terminated</option>
          <option value="Inactive">Inactive</option>
          <option value="Suspended">Suspended</option>
          <option value="Probationary">Probationary</option>
          <option value="Contract Ended">Contract Ended</option>
          <option value="Resigned">Resigned</option>
          <option value="Retired">Retired</option>
        </select>
      </label>
    </div>
    <div style="display:flex; justify-content:space-between; align-items:center; margin-top:0.5rem;">
      <div id="compFilterSummary" class="muted">No filters applied</div>
      <button class="actions-btn" style="background:#198754;" onclick="window.clearCompensationFilters?.()">Clear All Filters</button>
    </div>
  </div>
  <!-- Table -->
  <div class="table-wrapper">
    <table id="comp-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Department</th>
          <th>Position</th>
          <th>Job Level</th>
          <th>Contract Status</th>
          <th>Rate Type</th>
          <th>Base Salary</th>
          <th>Allowance <span style="color:#17a2b8; font-size:0.7rem;">(De Minimis)</span></th>
          <th style="text-align:center;">Actions</th>
        </tr>
      </thead>
      <tbody id="compTableBody">
        <!-- Data will be loaded here -->
      </tbody>
    </table>
  </div>
  <!-- Pagination Controls -->
  <div class="pagination-controls" style="display:flex; justify-content:space-between; align-items:center; margin-top:1rem; padding:0.75rem; background:rgba(25,135,84,0.05); border-radius:8px; border:1px solid #275b48;">
    <div style="display:flex; align-items:center; gap:0.5rem;">
      <span style="color:#ccc;">Show</span>
      <select id="compPageSize" onchange="window.changeCompPageSize?.()" style="padding:0.25rem 0.5rem; border-radius:4px; background:#0d1b0e; color:#fff; border:1px solid #275b48;">
        <option value="10">10</option>
        <option value="20">20</option>
        <option value="30">30</option>
        <option value="40">40</option>
        <option value="50">50</option>
      </select>
      <span style="color:#ccc;">entries</span>
    </div>
    <div style="display:flex; align-items:center; gap:0.5rem;">
      <button class="actions-btn" id="compPrevBtn" onclick="window.prevCompPage?.()">‚Üê Previous</button>
      <span id="compPageInfo" style="color:#ccc; padding:0 0.5rem;">Page 1 of 1</span>
      <button class="actions-btn" id="compNextBtn" onclick="window.nextCompPage?.()">Next ‚Üí</button>
    </div>
    <div style="color:#ccc;" id="compShowingInfo">Showing 1-10 of 0</div>
  </div>
</div>

<!-- Include Payroll Summary Dashboard -->
<div id="payrollSummaryContainer"></div>
<script>
  // Dynamically load payroll summary component
  fetch('./payroll-summary.html')
    .then(response => response.text())
    .then(html => {
      document.getElementById('payrollSummaryContainer').innerHTML = html;
    })
    .catch(err => console.warn('Could not load payroll summary:', err));
</script>

<!-- Include Government Remittance Reports -->
<div id="remittanceReportsContainer"></div>
<script>
  // Dynamically load remittance reports component
  fetch('./remittance-reports.html')
    .then(response => response.text())
    .then(html => {
      document.getElementById('remittanceReportsContainer').innerHTML = html;
    })
    .catch(err => console.warn('Could not load remittance reports:', err));
</script>

<!-- Include Government Contribution Reference Tables -->
<div id="referenceTablesContainer"></div>
<script>
  // Dynamically load reference tables component
  fetch('./contribution-reference-tables.html')
    .then(response => response.text())
    .then(html => {
      document.getElementById('referenceTablesContainer').innerHTML = html;
    })
    .catch(err => console.warn('Could not load reference tables:', err));
</script>

<!-- Add Compensation Modal -->
<div id="addCompensationModal" class="modal">
  <div class="modal-content" role="dialog" aria-modal="true" style="max-width:720px; padding:0; overflow:hidden;">
    <span class="close" onclick="window.closeAddCompensationModal()" style="top:1rem; right:1.25rem; z-index:10;">&times;</span>
    
    <!-- Modal Header with gradient -->
    <div style="background:linear-gradient(135deg, #0f5132 0%, #198754 100%); padding:1.25rem 1.5rem; border-bottom:2px solid #28a745;">
      <h3 style="margin:0; color:#fff; font-size:1.3rem; font-weight:600;">
        <span style="margin-right:0.5rem;">üí∞</span>Add Payroll Record
      </h3>
      <p class="muted" id="addCompEmployeeInfo" style="color:rgba(255,255,255,0.8); font-size:0.85rem; margin:0.25rem 0 0;">Select an employee to begin</p>
    </div>
    
    <div style="padding:1.5rem;">
      <!-- Employee Header (shown when employee is selected) -->
      <div id="compEmployeeHeader" class="employee-header" style="display:none; margin-bottom:1.25rem; padding:1rem 1.25rem; background:linear-gradient(135deg, rgba(25,135,84,0.15) 0%, rgba(15,81,50,0.1) 100%); border:1px solid rgba(40,167,69,0.3); border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,0.15);">
        <div style="display:flex; align-items:center; gap:1rem;">
          <div id="compEmployeeInitials" style="width:52px; height:52px; background:linear-gradient(135deg,#198754,#28a745); border-radius:50%; display:flex; align-items:center; justify-content:center; color:#fff; font-weight:bold; font-size:1.15rem; box-shadow:0 3px 10px rgba(25,135,84,0.4);">??</div>
          <div style="flex:1;">
            <div id="compEmployeeNameHeader" style="font-weight:600; color:#fff; font-size:1.1rem;">Employee Name</div>
            <div style="display:flex; flex-wrap:wrap; gap:0.5rem; margin-top:0.35rem;">
              <span id="compEmployeeIdHeader" style="font-size:0.75rem; color:#28a745; background:rgba(40,167,69,0.15); padding:0.2rem 0.5rem; border-radius:4px; border:1px solid rgba(40,167,69,0.3);">ID: --</span>
              <span id="compEmployeeDeptHeader" style="font-size:0.75rem; color:#ffc107; background:rgba(255,193,7,0.1); padding:0.2rem 0.5rem; border-radius:4px; border:1px solid rgba(255,193,7,0.3);">Department: --</span>
              <span id="compEmployeeRateHeader" style="font-size:0.75rem; color:#0dcaf0; background:rgba(13,202,240,0.1); padding:0.2rem 0.5rem; border-radius:4px; border:1px solid rgba(13,202,240,0.3);">Rate Type: --</span>
            </div>
          </div>
        </div>
      </div>

      <!-- SSS Age Exemption Banner (60+ years old) -->
      <div id="sssAgeExemptionBanner" style="display:none; margin-bottom:1.25rem; padding:0.85rem 1rem; background:linear-gradient(135deg, rgba(255,193,7,0.15) 0%, rgba(255,152,0,0.1) 100%); border:1px solid rgba(255,193,7,0.4); border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,0.15);">
        <div style="display:flex; align-items:center; gap:0.75rem;">
          <span style="font-size:1.5rem;">‚ö†Ô∏è</span>
          <div>
            <div style="font-weight:600; color:#ffc107; font-size:0.95rem;">SSS Contribution Exempt</div>
            <div style="font-size:0.8rem; color:#e0b800; margin-top:0.15rem;">This employee is 60 years old or above and is no longer required to contribute to SSS.</div>
          </div>
        </div>
      </div>

      <!-- Pag-IBIG Age Exemption Banner (60+ years old) -->
      <div id="pagibigAgeExemptionBanner" style="display:none; margin-bottom:1.25rem; padding:0.85rem 1rem; background:linear-gradient(135deg, rgba(111,66,193,0.15) 0%, rgba(90,50,163,0.1) 100%); border:1px solid rgba(111,66,193,0.4); border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,0.15);">
        <div style="display:flex; align-items:center; gap:0.75rem;">
          <span style="font-size:1.5rem;">üè†</span>
          <div>
            <div style="font-weight:600; color:#a78bfa; font-size:0.95rem;">Pag-IBIG Contribution Exempt</div>
            <div style="font-size:0.8rem; color:#8b5cf6; margin-top:0.15rem;">This employee is 60 years old or above and is no longer required to contribute to Pag-IBIG.</div>
          </div>
        </div>
      </div>

      <form id="addCompensationForm">
        <!-- Employee Selection -->
        <div style="margin-bottom:1.25rem;">
          <label style="color:#b5d8c8; font-size:0.8rem; font-weight:500; text-transform:uppercase; letter-spacing:0.5px; display:block; margin-bottom:0.4rem;">Select Employee <span style="color:#ff6b6b;">*</span></label>
          <select id="compEmployeeSelect" required style="width:100%; padding:0.65rem 0.75rem; border-radius:8px; border:1px solid #275b48; background:#fff; color:#000; font-size:0.95rem; cursor:pointer; transition:all 0.2s ease;">
            <option value="">-- Select Employee --</option>
          </select>
          <input type="hidden" id="addCompEmployeeId" name="employeeId">
        </div>

        <!-- Two Column Layout for Earnings and Deductions -->
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:1rem; margin-bottom:1.25rem;">
          
          <!-- Earnings Section -->
          <div style="border:1px solid #275b48; border-radius:10px; overflow:hidden; background:rgba(0,0,0,0.2);">
            <div style="background:linear-gradient(135deg, rgba(40,167,69,0.2) 0%, rgba(40,167,69,0.05) 100%); padding:0.65rem 1rem; border-bottom:1px solid rgba(40,167,69,0.3);">
              <h4 style="margin:0; color:#28a745; font-size:0.9rem; font-weight:600; display:flex; align-items:center; gap:0.4rem;">
                <span style="font-size:1rem;">üìà</span> Earnings
              </h4>
            </div>
            <div style="padding:1rem;">
              <div style="margin-bottom:0.85rem;">
                <label style="color:#8ab8a8; font-size:0.75rem; display:block; margin-bottom:0.3rem;">Base Salary</label>
                <div style="position:relative;">
                  <span style="position:absolute; left:0.75rem; top:50%; transform:translateY(-50%); color:#28a745; font-weight:500;">‚Ç±</span>
                  <input type="number" step="0.01" min="0" id="addCompBaseSalary" name="baseSalary" value="0.00" style="width:100%; padding:0.55rem 0.75rem 0.55rem 1.75rem; border-radius:6px; border:1px solid #275b48; background:#0d1b0e; color:#28a745; font-weight:500; text-align:right;">
                </div>
              </div>
              <div style="margin-bottom:0.85rem;">
                <label style="color:#8ab8a8; font-size:0.75rem; display:block; margin-bottom:0.3rem;">Allowances</label>
                <div style="position:relative;">
                  <span style="position:absolute; left:0.75rem; top:50%; transform:translateY(-50%); color:#28a745; font-weight:500;">‚Ç±</span>
                  <input type="number" step="0.01" min="0" id="addCompAllowances" name="allowances" value="0.00" style="width:100%; padding:0.55rem 0.75rem 0.55rem 1.75rem; border-radius:6px; border:1px solid #275b48; background:#0d1b0e; color:#28a745; font-weight:500; text-align:right;">
                </div>
              </div>
              <div>
                <label style="color:#8ab8a8; font-size:0.75rem; display:block; margin-bottom:0.3rem;">Overtime Rate</label>
                <div style="position:relative;">
                  <span style="position:absolute; left:0.75rem; top:50%; transform:translateY(-50%); color:#28a745; font-weight:500;">‚Ç±</span>
                  <input type="number" step="0.01" min="0" id="addCompOvertime" name="overtime" value="0.00" style="width:100%; padding:0.55rem 0.75rem 0.55rem 1.75rem; border-radius:6px; border:1px solid #275b48; background:#0d1b0e; color:#28a745; font-weight:500; text-align:right;">
                </div>
                <p id="compOvertimeNote" style="font-size:0.7rem; color:#ffc107; margin:0.25rem 0 0; display:none;">‚ö†Ô∏è Not applicable for fixed rate</p>
              </div>
            </div>
          </div>

          <!-- Deductions Section -->
          <div style="border:1px solid #275b48; border-radius:10px; overflow:hidden; background:rgba(0,0,0,0.2);">
            <div style="background:linear-gradient(135deg, rgba(220,53,69,0.2) 0%, rgba(220,53,69,0.05) 100%); padding:0.65rem 1rem; border-bottom:1px solid rgba(220,53,69,0.3);">
              <h4 style="margin:0; color:#dc3545; font-size:0.9rem; font-weight:600; display:flex; align-items:center; gap:0.4rem;">
                <span style="font-size:1rem;">üìâ</span> Deductions
              </h4>
            </div>
            <div style="padding:1rem;">
              <div style="display:grid; grid-template-columns:1fr 1fr; gap:0.5rem;">
                <div>
                  <label style="color:#8ab8a8; font-size:0.7rem; display:block; margin-bottom:0.25rem;">SSS</label>
                  <div style="position:relative;">
                    <span style="position:absolute; left:0.5rem; top:50%; transform:translateY(-50%); color:#dc3545; font-weight:500; font-size:0.85rem;">‚Ç±</span>
                    <input type="number" step="0.01" min="0" id="addCompSSS" name="sss" value="0.00" readonly style="width:100%; padding:0.45rem 0.5rem 0.45rem 1.5rem; border-radius:5px; border:1px solid #275b48; background:#0d1b0e; color:#dc3545; font-weight:500; text-align:right; font-size:0.85rem;">
                  </div>
                </div>
                <div>
                  <label style="color:#8ab8a8; font-size:0.7rem; display:block; margin-bottom:0.25rem;">PhilHealth</label>
                  <div style="position:relative;">
                    <span style="position:absolute; left:0.5rem; top:50%; transform:translateY(-50%); color:#dc3545; font-weight:500; font-size:0.85rem;">‚Ç±</span>
                    <input type="number" step="0.01" min="0" id="addCompPhilHealth" name="philHealth" value="0.00" readonly style="width:100%; padding:0.45rem 0.5rem 0.45rem 1.5rem; border-radius:5px; border:1px solid #275b48; background:#0d1b0e; color:#dc3545; font-weight:500; text-align:right; font-size:0.85rem;">
                  </div>
                </div>
                <div>
                  <label style="color:#8ab8a8; font-size:0.7rem; display:block; margin-bottom:0.25rem;">Pag-IBIG</label>
                  <div style="position:relative;">
                    <span style="position:absolute; left:0.5rem; top:50%; transform:translateY(-50%); color:#dc3545; font-weight:500; font-size:0.85rem;">‚Ç±</span>
                    <input type="number" step="0.01" min="0" id="addCompPagIbig" name="pagIbig" value="0.00" readonly style="width:100%; padding:0.45rem 0.5rem 0.45rem 1.5rem; border-radius:5px; border:1px solid #275b48; background:#0d1b0e; color:#dc3545; font-weight:500; text-align:right; font-size:0.85rem;">
                  </div>
                </div>
                <div>
                  <label style="color:#8ab8a8; font-size:0.7rem; display:block; margin-bottom:0.25rem;">Tax</label>
                  <div style="position:relative;">
                    <span style="position:absolute; left:0.5rem; top:50%; transform:translateY(-50%); color:#dc3545; font-weight:500; font-size:0.85rem;">‚Ç±</span>
                    <input type="number" step="0.01" min="0" id="addCompTax" name="tax" value="0.00" readonly style="width:100%; padding:0.45rem 0.5rem 0.45rem 1.5rem; border-radius:5px; border:1px solid #275b48; background:#0d1b0e; color:#dc3545; font-weight:500; text-align:right; font-size:0.85rem;">
                  </div>
                </div>
              </div>
              <p style="font-size:0.65rem; color:#6c757d; margin:0.75rem 0 0; padding:0.4rem; background:rgba(108,117,125,0.1); border-radius:4px; text-align:center;">
                ‚ÑπÔ∏è Auto-calculated based on salary (monthly basis)
              </p>
            </div>
          </div>
        </div>

        <!-- Summary/Totals Section -->
        <div style="background:linear-gradient(135deg, rgba(13,202,240,0.1) 0%, rgba(13,27,14,0.3) 100%); border:1px solid rgba(13,202,240,0.3); border-radius:10px; padding:1rem 1.25rem; margin-bottom:1.25rem;">
          <div style="display:grid; grid-template-columns:repeat(3, 1fr); gap:1rem;">
            <div style="text-align:center;">
              <label style="color:#8ab8a8; font-size:0.7rem; text-transform:uppercase; letter-spacing:0.5px; display:block; margin-bottom:0.35rem;">Gross Pay</label>
              <input type="number" step="0.01" id="addCompGrossPay" name="grossPay" readonly style="width:100%; padding:0.5rem; border-radius:6px; border:1px solid #275b48; background:rgba(0,0,0,0.3); color:#28a745; font-weight:700; font-size:1.1rem; text-align:center;">
            </div>
            <div style="text-align:center;">
              <label style="color:#8ab8a8; font-size:0.7rem; text-transform:uppercase; letter-spacing:0.5px; display:block; margin-bottom:0.35rem;">Deductions</label>
              <input type="number" step="0.01" id="addCompTotalDeductions" name="totalDeductions" readonly style="width:100%; padding:0.5rem; border-radius:6px; border:1px solid #275b48; background:rgba(0,0,0,0.3); color:#dc3545; font-weight:700; font-size:1.1rem; text-align:center;">
            </div>
            <div style="text-align:center;">
              <label style="color:#0dcaf0; font-size:0.7rem; text-transform:uppercase; letter-spacing:0.5px; display:block; margin-bottom:0.35rem;">Net Pay</label>
              <input type="number" step="0.01" id="addCompNetPay" name="netPay" readonly style="width:100%; padding:0.5rem; border-radius:6px; border:2px solid rgba(13,202,240,0.5); background:rgba(13,202,240,0.1); color:#0dcaf0; font-weight:700; font-size:1.1rem; text-align:center;">
            </div>
          </div>
        </div>

        <!-- Remarks -->
        <div style="margin-bottom:1.25rem;">
          <label style="color:#b5d8c8; font-size:0.8rem; font-weight:500; text-transform:uppercase; letter-spacing:0.5px; display:block; margin-bottom:0.4rem;">Remarks</label>
          <textarea id="addCompRemarks" name="remarks" rows="2" placeholder="Optional remarks or notes..." style="width:100%; padding:0.65rem 0.75rem; border-radius:8px; border:1px solid #275b48; background:linear-gradient(135deg, #0d1b0e 0%, #1a2a1a 100%); color:#fff; resize:vertical; font-size:0.9rem;"></textarea>
        </div>

        <!-- Modal Footer -->
        <div style="display:flex; justify-content:flex-end; gap:0.75rem; padding-top:1rem; border-top:1px solid #275b48;">
          <button type="button" onclick="window.closeAddCompensationModal()" style="background:linear-gradient(135deg, #4a5568 0%, #2d3748 100%); color:#fff; border:none; border-radius:8px; padding:0.65rem 1.5rem; font-size:0.9rem; font-weight:500; cursor:pointer; transition:all 0.2s ease;">Cancel</button>
          <button type="submit" class="btn-primary" style="border-radius:8px; padding:0.65rem 1.75rem; font-size:0.9rem; display:flex; align-items:center; gap:0.4rem;">
            <span>‚úì</span> Add Payroll
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- View Compensation Modal -->
<div id="viewCompensationModal" class="modal">
  <div class="modal-content" role="dialog" aria-modal="true" style="max-width:820px; padding:0; overflow:hidden;">
    <span class="close" onclick="window.closeViewCompensationModal()" style="top:1rem; right:1.25rem; z-index:10;">&times;</span>
    
    <!-- Modal Header with gradient -->
    <div style="background:linear-gradient(135deg, #0f5132 0%, #198754 100%); padding:1.25rem 1.5rem; border-bottom:2px solid #28a745;">
      <h3 style="margin:0; color:#fff; font-size:1.3rem; font-weight:600;">
        <span style="margin-right:0.5rem;">üìã</span>Payroll Details
      </h3>
      <p style="color:rgba(255,255,255,0.85); font-size:0.9rem; margin:0.35rem 0 0;" id="viewPayrollEmployeeInfo">Employee Name (ID) - Department</p>
      <!-- Hidden fields for breakdown modal -->
      <input type="hidden" id="viewCompEmpId" value="">
      <input type="hidden" id="viewCompEmpName" value="">
      <input type="hidden" id="viewCompDept" value="">
    </div>

    <div style="padding:1.5rem;">
      <!-- Two Column Layout for Earnings and Deductions -->
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:1rem; margin-bottom:1.25rem;">
        
        <!-- Earnings Section -->
        <div style="border:1px solid #275b48; border-radius:10px; overflow:hidden; background:rgba(0,0,0,0.2);">
          <div style="background:linear-gradient(135deg, rgba(40,167,69,0.2) 0%, rgba(40,167,69,0.05) 100%); padding:0.65rem 1rem; border-bottom:1px solid rgba(40,167,69,0.3);">
            <h4 style="margin:0; color:#28a745; font-size:0.9rem; font-weight:600; display:flex; align-items:center; gap:0.4rem;">
              <span style="font-size:1rem;">üìà</span> Earnings
            </h4>
          </div>
          <div style="padding:1rem;">
            <div style="display:flex; flex-direction:column; gap:0.75rem;">
              <div style="display:flex; justify-content:space-between; align-items:center;">
                <span style="color:#8ab8a8; font-size:0.85rem;">Basic Salary</span>
                <div style="position:relative; width:130px;">
                  <span style="position:absolute; left:0.6rem; top:50%; transform:translateY(-50%); color:#28a745; font-size:0.85rem;">‚Ç±</span>
                  <input type="number" step="0.01" min="0" id="viewBasicSalary" value="0.00" readonly
                         style="width:100%; padding:0.45rem 0.6rem 0.45rem 1.5rem; border-radius:6px; border:1px solid #275b48; background:#0d1b0e; color:#28a745; text-align:right; font-weight:500; font-size:0.9rem;">
                </div>
              </div>
              <div style="display:flex; justify-content:space-between; align-items:center;">
                <span style="color:#8ab8a8; font-size:0.85rem;">Allowances</span>
                <div style="position:relative; width:130px;">
                  <span style="position:absolute; left:0.6rem; top:50%; transform:translateY(-50%); color:#28a745; font-size:0.85rem;">‚Ç±</span>
                  <input type="number" step="0.01" min="0" id="viewAllowances" value="0.00" readonly
                         style="width:100%; padding:0.45rem 0.6rem 0.45rem 1.5rem; border-radius:6px; border:1px solid #275b48; background:#0d1b0e; color:#28a745; text-align:right; font-weight:500; font-size:0.9rem;">
                </div>
              </div>
              <div style="display:flex; justify-content:space-between; align-items:center;">
                <span style="color:#8ab8a8; font-size:0.85rem;">Overtime Rate</span>
                <div style="position:relative; width:130px;">
                  <span style="position:absolute; left:0.6rem; top:50%; transform:translateY(-50%); color:#28a745; font-size:0.85rem;">‚Ç±</span>
                  <input type="number" step="0.01" min="0" id="viewOvertimePay" value="0.00" readonly
                         style="width:100%; padding:0.45rem 0.6rem 0.45rem 1.5rem; border-radius:6px; border:1px solid #275b48; background:#0d1b0e; color:#28a745; text-align:right; font-weight:500; font-size:0.9rem;">
                </div>
              </div>
              <div style="display:flex; justify-content:space-between; align-items:center; border-top:1px solid rgba(40,167,69,0.3); padding-top:0.75rem; margin-top:0.25rem;">
                <span style="color:#fff; font-weight:600; font-size:0.9rem;">Gross Pay</span>
                <div style="position:relative; width:130px;">
                  <span style="position:absolute; left:0.6rem; top:50%; transform:translateY(-50%); color:#28a745; font-size:0.85rem;">‚Ç±</span>
                  <input type="number" step="0.01" min="0" id="viewGrossPay" value="0.00" readonly
                         style="width:100%; padding:0.45rem 0.6rem 0.45rem 1.5rem; border-radius:6px; border:1px solid rgba(40,167,69,0.5); background:rgba(40,167,69,0.1); color:#28a745; text-align:right; font-weight:700; font-size:0.95rem;">
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Deductions Section - Government Mandated Only -->
        <div style="border:1px solid #275b48; border-radius:10px; overflow:hidden; background:rgba(0,0,0,0.2);">
          <div style="background:linear-gradient(135deg, rgba(220,53,69,0.2) 0%, rgba(220,53,69,0.05) 100%); padding:0.65rem 1rem; border-bottom:1px solid rgba(220,53,69,0.3);">
            <h4 style="margin:0; color:#dc3545; font-size:0.9rem; font-weight:600; display:flex; align-items:center; gap:0.4rem;">
              <span style="font-size:1rem;">üìâ</span> Deductions
            </h4>
          </div>
          <div style="padding:1rem;">
            <div style="display:flex; flex-direction:column; gap:0.75rem;">
              <!-- SSS Contribution -->
              <div style="display:flex; justify-content:space-between; align-items:center;">
                <span style="color:#8ab8a8; font-size:0.85rem;">SSS Contribution</span>
                <div style="position:relative; width:130px;">
                  <span style="position:absolute; left:0.6rem; top:50%; transform:translateY(-50%); color:#dc3545; font-size:0.85rem;">‚Ç±</span>
                  <input type="number" step="0.01" min="0" id="viewSSS" value="0.00" readonly
                         style="width:100%; padding:0.45rem 0.6rem 0.45rem 1.5rem; border-radius:6px; border:1px solid #275b48; background:#0d1b0e; color:#dc3545; text-align:right; font-weight:500; font-size:0.9rem;">
                </div>
              </div>
              <!-- PhilHealth Contribution -->
              <div style="display:flex; justify-content:space-between; align-items:center;">
                <span style="color:#8ab8a8; font-size:0.85rem;">PhilHealth</span>
                <div style="position:relative; width:130px;">
                  <span style="position:absolute; left:0.6rem; top:50%; transform:translateY(-50%); color:#dc3545; font-size:0.85rem;">‚Ç±</span>
                  <input type="number" step="0.01" min="0" id="viewPhilHealth" value="0.00" readonly
                         style="width:100%; padding:0.45rem 0.6rem 0.45rem 1.5rem; border-radius:6px; border:1px solid #275b48; background:#0d1b0e; color:#dc3545; text-align:right; font-weight:500; font-size:0.9rem;">
                </div>
              </div>
              <!-- Pag-IBIG Contribution -->
              <div style="display:flex; justify-content:space-between; align-items:center;">
                <span style="color:#8ab8a8; font-size:0.85rem;">Pag-IBIG</span>
                <div style="position:relative; width:130px;">
                  <span style="position:absolute; left:0.6rem; top:50%; transform:translateY(-50%); color:#dc3545; font-size:0.85rem;">‚Ç±</span>
                  <input type="number" step="0.01" min="0" id="viewPagIbig" value="0.00" readonly
                         style="width:100%; padding:0.45rem 0.6rem 0.45rem 1.5rem; border-radius:6px; border:1px solid #275b48; background:#0d1b0e; color:#dc3545; text-align:right; font-weight:500; font-size:0.9rem;">
                </div>
              </div>
              <!-- Withholding Tax (BIR) -->
              <div style="display:flex; justify-content:space-between; align-items:center;">
                <span style="color:#8ab8a8; font-size:0.85rem;">Withholding Tax</span>
                <div style="position:relative; width:130px;">
                  <span style="position:absolute; left:0.6rem; top:50%; transform:translateY(-50%); color:#dc3545; font-size:0.85rem;">‚Ç±</span>
                  <input type="number" step="0.01" min="0" id="viewWithholdingTax" value="0.00" readonly
                         style="width:100%; padding:0.45rem 0.6rem 0.45rem 1.5rem; border-radius:6px; border:1px solid #275b48; background:#0d1b0e; color:#dc3545; text-align:right; font-weight:500; font-size:0.9rem;">
                </div>
              </div>
              <!-- Total Deductions -->
              <div style="display:flex; justify-content:space-between; align-items:center; border-top:1px solid rgba(220,53,69,0.3); padding-top:0.75rem; margin-top:0.25rem;">
                <span style="color:#fff; font-weight:600; font-size:0.9rem;">Total Deductions</span>
                <div style="position:relative; width:130px;">
                  <span style="position:absolute; left:0.6rem; top:50%; transform:translateY(-50%); color:#dc3545; font-size:0.85rem;">‚Ç±</span>
                  <input type="number" step="0.01" min="0" id="viewTotalDeductions" value="0.00" readonly
                         style="width:100%; padding:0.45rem 0.6rem 0.45rem 1.5rem; border-radius:6px; border:1px solid rgba(220,53,69,0.5); background:rgba(220,53,69,0.1); color:#dc3545; text-align:right; font-weight:700; font-size:0.95rem;">
                </div>
              </div>
              <p style="font-size:0.7rem; color:#6c757d; margin:0.5rem 0 0; padding:0.5rem; background:rgba(108,117,125,0.1); border-radius:4px; text-align:center;">
                ‚ÑπÔ∏è Salary Advance deductions are applied in Payroll Breakdown
              </p>
              <!-- SSS Age Exemption Banner for View Modal (60+ years old) -->
              <div id="viewSssAgeExemptionBanner" style="display:none; margin-top:0.5rem; padding:0.5rem 0.65rem; background:linear-gradient(135deg, rgba(255,193,7,0.15) 0%, rgba(255,152,0,0.1) 100%); border:1px solid rgba(255,193,7,0.4); border-radius:6px;">
                <div style="display:flex; align-items:center; gap:0.5rem;">
                  <span style="font-size:1rem;">‚ö†Ô∏è</span>
                  <div style="font-size:0.7rem; color:#ffc107;">This employee is 60 years old or above and is no longer required to contribute to SSS.</div>
                </div>
              </div>
              <!-- Pag-IBIG Age Exemption Banner for View Modal (60+ years old) -->
              <div id="viewPagibigAgeExemptionBanner" style="display:none; margin-top:0.5rem; padding:0.5rem 0.65rem; background:linear-gradient(135deg, rgba(111,66,193,0.15) 0%, rgba(90,50,163,0.1) 100%); border:1px solid rgba(111,66,193,0.4); border-radius:6px;">
                <div style="display:flex; align-items:center; gap:0.5rem;">
                  <span style="font-size:1rem;">üè†</span>
                  <div style="font-size:0.7rem; color:#a78bfa;">This employee is 60 years old or above and is no longer required to contribute to Pag-IBIG.</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Net Pay Summary -->
      <div style="background:linear-gradient(135deg, rgba(13,202,240,0.15) 0%, rgba(13,27,14,0.3) 100%); border:1px solid rgba(13,202,240,0.4); border-radius:10px; padding:1rem 1.25rem; margin-bottom:1.25rem;">
        <div style="display:flex; justify-content:space-between; align-items:center;">
          <div>
            <span style="font-size:1.1rem; font-weight:600; color:#fff;">üíµ Net Pay</span>
            <p style="margin:0.2rem 0 0; font-size:0.75rem; color:#8ab8a8;">Total amount after deductions</p>
          </div>
          <div style="position:relative; width:180px;">
            <span style="position:absolute; left:0.75rem; top:50%; transform:translateY(-50%); color:#0dcaf0; font-size:1rem; font-weight:600;">‚Ç±</span>
            <input type="number" step="0.01" id="viewNetPay" value="0.00" readonly
                   style="width:100%; padding:0.6rem 0.75rem 0.6rem 1.75rem; border-radius:8px; border:2px solid rgba(13,202,240,0.5); background:rgba(13,202,240,0.1); color:#0dcaf0; text-align:right; font-weight:700; font-size:1.25rem;">
          </div>
        </div>
      </div>

      <!-- Remarks Section -->
      <div style="margin-bottom:1.25rem;">
        <label style="color:#b5d8c8; font-size:0.8rem; font-weight:500; text-transform:uppercase; letter-spacing:0.5px; display:block; margin-bottom:0.4rem;">Remarks</label>
        <textarea id="viewRemarks" rows="2" readonly placeholder="No remarks" 
                  style="width:100%; padding:0.65rem 0.75rem; border-radius:8px; border:1px solid #275b48; background:linear-gradient(135deg, #0d1b0e 0%, #1a2a1a 100%); color:#fff; resize:none; font-size:0.9rem;"></textarea>
      </div>

      <!-- Breakdown History Section -->
      <div style="margin-bottom:1rem;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:0.75rem; flex-wrap:wrap; gap:0.5rem;">
          <h4 style="margin:0; color:#fff; font-size:0.95rem; display:flex; align-items:center; gap:0.4rem;">
            <span>üìä</span> Breakdown History
          </h4>
          <select id="breakdownFilterSelect" onchange="window.filterBreakdownHistory(this.value)" 
                  style="padding:0.4rem 0.75rem; font-size:0.8rem; background:#fff; color:#000; border:1px solid #275b48; border-radius:6px; cursor:pointer;">
            <option value="all">All Periods</option>
            <option value="1st">1st Cut</option>
            <option value="2nd">2nd Cut</option>
            <option value="whole">Whole Month</option>
          </select>
        </div>
        <div style="max-height:200px; overflow-y:auto; border:1px solid #275b48; border-radius:8px; background:rgba(0,0,0,0.2);">
          <table class="table" style="margin:0; width:100%;">
            <thead style="position:sticky; top:0; background:linear-gradient(135deg, #1a2a1a 0%, #0d1b0e 100%);">
              <tr>
                <th style="padding:0.6rem 0.5rem; text-align:left; color:#fff; border-bottom:1px solid #275b48; font-size:0.8rem;">Period</th>
                <th style="padding:0.6rem 0.5rem; text-align:center; color:#fff; border-bottom:1px solid #275b48; font-size:0.8rem;">Days</th>
                <th style="padding:0.6rem 0.5rem; text-align:right; color:#28a745; border-bottom:1px solid #275b48; font-size:0.8rem;">Earnings</th>
                <th style="padding:0.6rem 0.5rem; text-align:right; color:#dc3545; border-bottom:1px solid #275b48; font-size:0.8rem;">Deductions</th>
                <th style="padding:0.6rem 0.5rem; text-align:right; color:#0dcaf0; border-bottom:1px solid #275b48; font-size:0.8rem;">Net Pay</th>
                <th style="padding:0.6rem 0.5rem; text-align:center; color:#fff; border-bottom:1px solid #275b48; font-size:0.8rem;">Actions</th>
              </tr>
            </thead>
            <tbody id="breakdownHistoryBody">
              <tr>
                <td colspan="6" style="text-align:center; padding:1.5rem; color:#6c757d; font-size:0.9rem;">
                  No breakdown records found
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Modal Footer -->
      <div style="display:flex; justify-content:space-between; gap:0.75rem; padding-top:1rem; border-top:1px solid #275b48;">
        <div style="display:flex; gap:0.5rem;">
          <button type="button" onclick="window.showDailyBreakdownModal()" style="background:linear-gradient(135deg, #0f5132 0%, #198754 100%); color:#fff; border:none; border-radius:8px; padding:0.65rem 1.25rem; font-size:0.9rem; font-weight:500; cursor:pointer; transition:all 0.2s ease; display:flex; align-items:center; gap:0.4rem;">
            <span>‚ûï</span> Add Payroll Breakdown
          </button>
        </div>
        <button type="button" onclick="window.closeViewCompensationModal()" style="background:linear-gradient(135deg, #4a5568 0%, #2d3748 100%); color:#fff; border:none; border-radius:8px; padding:0.65rem 1.5rem; font-size:0.9rem; font-weight:500; cursor:pointer; transition:all 0.2s ease;">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Edit Salary Modal -->
<div id="editSalaryModal" class="modal">
  <div class="modal-content" role="dialog" aria-modal="true" style="max-width:500px; padding:0; overflow:hidden;">
    <span class="close" onclick="window.closeEditSalaryModal()" style="top:1rem; right:1.25rem; z-index:10;">&times;</span>
    
    <!-- Modal Header with gradient -->
    <div style="background:linear-gradient(135deg, #0dcaf0 0%, #0aa2c0 100%); padding:1.25rem 1.5rem; border-bottom:2px solid #17a2b8;">
      <h3 style="margin:0; color:#0d1b0e; font-size:1.3rem; font-weight:600;">
        <span style="margin-right:0.5rem;">‚úèÔ∏è</span>Edit Salary Information
      </h3>
      <p style="color:rgba(0,0,0,0.7); font-size:0.85rem; margin:0.25rem 0 0;" id="editSalaryEmployeeInfo">Employee Name</p>
    </div>
    
    <div style="padding:1.5rem;">
      <form id="editSalaryForm">
        <input type="hidden" id="editSalaryRecordId">
        <input type="hidden" id="editSalaryEmployeeId">
        
        <!-- Current Values Info -->
        <div style="margin-bottom:1.25rem; padding:0.75rem; background:rgba(13,202,240,0.1); border:1px solid rgba(13,202,240,0.3); border-radius:8px;">
          <div style="color:#0dcaf0; font-size:0.8rem; font-weight:600; margin-bottom:0.5rem;">‚ÑπÔ∏è Note</div>
          <div style="color:#ccc; font-size:0.85rem;">Changes here will update the employee's base salary information in the Employee Directory. This affects future payroll calculations.</div>
        </div>
        
        <!-- Base Salary -->
        <div style="margin-bottom:1rem;">
          <label style="color:#b5d8c8; font-size:0.8rem; font-weight:500; text-transform:uppercase; letter-spacing:0.5px; display:block; margin-bottom:0.4rem;">Base Salary (Monthly)</label>
          <div style="position:relative;">
            <span style="position:absolute; left:0.75rem; top:50%; transform:translateY(-50%); color:#28a745; font-weight:500;">‚Ç±</span>
            <input type="number" step="0.01" min="0" id="editBaseSalary" name="baseSalary" value="0.00" 
                   style="width:100%; padding:0.65rem 0.75rem 0.65rem 1.75rem; border-radius:8px; border:1px solid #275b48; background:#0d1b0e; color:#28a745; font-weight:500; text-align:right; font-size:1rem;">
          </div>
        </div>
        
        <!-- Allowance -->
        <div style="margin-bottom:1.5rem;">
          <label style="color:#b5d8c8; font-size:0.8rem; font-weight:500; text-transform:uppercase; letter-spacing:0.5px; display:block; margin-bottom:0.4rem;">Monthly Allowance <span style="color:#17a2b8; font-size:0.7rem;">(De Minimis)</span></label>
          <div style="position:relative;">
            <span style="position:absolute; left:0.75rem; top:50%; transform:translateY(-50%); color:#17a2b8; font-weight:500;">‚Ç±</span>
            <input type="number" step="0.01" min="0" id="editAllowance" name="allowance" value="0.00" 
                   style="width:100%; padding:0.65rem 0.75rem 0.65rem 1.75rem; border-radius:8px; border:1px solid #275b48; background:#0d1b0e; color:#17a2b8; font-weight:500; text-align:right; font-size:1rem;">
          </div>
        </div>
        
        <!-- Buttons -->
        <div style="display:flex; justify-content:flex-end; gap:0.75rem; padding-top:1rem; border-top:1px solid #275b48;">
          <button type="button" onclick="window.closeEditSalaryModal()" class="actions-btn" style="background:#6c757d;">Cancel</button>
          <button type="submit" class="btn-primary" style="background:linear-gradient(135deg, #0dcaf0 0%, #0aa2c0 100%); color:#0d1b0e;">üíæ Save Changes</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="deleteCompensationModal" class="modal">
  <div class="modal-content" role="dialog" aria-modal="true" style="max-width:450px;">
    <span class="close" onclick="window.closeDeleteCompensationModal()">&times;</span>
    <div class="modal-header">
      <h3 style="margin:0; color:#dc3545;">‚ö†Ô∏è Confirm Delete</h3>
    </div>
    <div class="modal-body">
      <p style="color:#ccc;">Are you sure you want to delete this payroll record? This action cannot be undone.</p>
      
      <!-- Warning about breakdown records -->
      <div id="deleteBreakdownWarning" style="display:none; margin-top:1rem; padding:0.75rem; background:linear-gradient(135deg, rgba(255,193,7,0.15) 0%, rgba(255,152,0,0.1) 100%); border:1px solid rgba(255,193,7,0.4); border-radius:8px;">
        <div style="display:flex; align-items:flex-start; gap:0.5rem;">
          <span style="font-size:1.25rem;">‚ö†Ô∏è</span>
          <div>
            <div style="font-weight:600; color:#ffc107; font-size:0.9rem;">Payroll History Breakdown Records</div>
            <div style="font-size:0.8rem; color:#e0b800; margin-top:0.25rem;">All associated payroll breakdown records (cutoff periods, deductions, etc.) for this employee will also be permanently deleted.</div>
          </div>
        </div>
      </div>
      
      <input type="hidden" id="deleteCompensationId">
      <input type="hidden" id="deleteCompensationEmployeeId">
    </div>
    <div style="display:flex; justify-content:flex-end; gap:0.75rem; padding-top:1rem; border-top:1px solid #275b48;">
      <button type="button" onclick="window.closeDeleteCompensationModal()" class="actions-btn" style="background:#6c757d;">Cancel</button>
      <button type="button" onclick="window.confirmDeleteCompensation()" class="actions-btn delete-btn">üóëÔ∏è Delete All</button>
    </div>
  </div>
</div>

<!-- Bulk Delete Compensation Modal -->
<div id="bulkDeleteCompModal" class="modal">
  <div class="modal-content" role="dialog" aria-modal="true" style="max-width:450px;">
    <span class="close" onclick="window.closeBulkDeleteCompModal()">&times;</span>
    <div class="modal-header">
      <h3 style="margin:0; color:#dc3545;">‚ö†Ô∏è Confirm Bulk Delete</h3>
    </div>
    <div class="modal-body">
      <p style="color:#ccc;">Are you sure you want to delete <strong id="bulkDeleteCompCount" style="color:#dc3545;">0</strong> compensation records?</p>
      <p style="color:#ff6b6b; font-size:0.9rem;">‚ö†Ô∏è This action cannot be undone!</p>
    </div>
    <div style="display:flex; justify-content:flex-end; gap:0.75rem; padding-top:1rem; border-top:1px solid #275b48;">
      <button type="button" onclick="window.closeBulkDeleteCompModal()" class="actions-btn" style="background:#6c757d;">Cancel</button>
      <button type="button" onclick="window.confirmBulkDeleteComp()" class="actions-btn delete-btn">üóëÔ∏è Delete All Selected</button>
    </div>
  </div>
</div>

<!-- Daily Breakdown Modal (Add/Edit) -->
<div id="dailyBreakdownModal" class="modal">
  <div class="modal-content" role="dialog" aria-modal="true" style="max-width:1200px; max-height:90vh; overflow-y:auto;">
    <span class="close" onclick="window.closeDailyBreakdownModal()">&times;</span>
    <div class="modal-header">
      <h3 style="margin:0; color:#fff;">Daily Breakdown</h3>
    </div>

    <!-- Employee Info Header -->
    <div id="breakdownEmployeeHeader" style="display:none; background:#1a2a1a; border-radius:8px; padding:1rem; margin-bottom:1rem; border:1px solid #275b48;">
      <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:1rem;">
        <!-- Left: Employee Info -->
        <div style="display:flex; align-items:center; gap:0.75rem;">
          <div style="width:45px; height:45px; background:#0dcaf0; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:700; font-size:1.1rem; color:#0d1b0e;" id="breakdownEmpInitials">JD</div>
          <div>
            <h4 style="margin:0; color:#fff; font-size:1rem;" id="breakdownEmpName">John Doe</h4>
            <div style="color:#0dcaf0; font-size:0.75rem; font-weight:500;" id="breakdownEmpId">EMP-0001</div>
            <div style="color:#ccc; font-size:0.8rem;" id="breakdownEmpDept">Department</div>
          </div>
        </div>
        <!-- Right: Rate Info -->
        <div style="display:flex; gap:1rem; flex-wrap:wrap; align-items:center;">
          <div style="text-align:center; padding:0.25rem 0.5rem; background:rgba(0,0,0,0.2); border-radius:4px;">
            <span style="color:#888; font-size:0.65rem; display:block; text-transform:uppercase;">Daily Rate</span>
            <span style="color:#0dcaf0; font-weight:600; font-size:0.85rem;" id="breakdownDailyRate">‚Ç±0.00</span>
          </div>
          <div style="text-align:center; padding:0.25rem 0.5rem; background:rgba(0,0,0,0.2); border-radius:4px;">
            <span style="color:#888; font-size:0.65rem; display:block; text-transform:uppercase;">Hourly Rate</span>
            <span style="color:#0dcaf0; font-weight:600; font-size:0.85rem;" id="breakdownHourlyRate">‚Ç±0.00</span>
          </div>
          <div style="text-align:center; padding:0.25rem 0.5rem; background:rgba(0,0,0,0.2); border-radius:4px;">
            <span style="color:#888; font-size:0.65rem; display:block; text-transform:uppercase;">OT Rate</span>
            <span style="color:#0dcaf0; font-weight:600; font-size:0.85rem;" id="breakdownOTRate">‚Ç±0.00</span>
          </div>
          <div style="text-align:center; padding:0.25rem 0.5rem; background:rgba(0,0,0,0.2); border-radius:4px;">
            <span style="color:#888; font-size:0.65rem; display:block; text-transform:uppercase;">Work Days</span>
            <span style="color:#fff; font-weight:600; font-size:0.85rem;" id="breakdownWorkDays">0</span>
          </div>
          <div style="text-align:center; padding:0.25rem 0.5rem; background:rgba(0,0,0,0.2); border-radius:4px;">
            <span style="color:#888; font-size:0.65rem; display:block; text-transform:uppercase;">Type</span>
            <span style="color:#ffc107; font-weight:600; font-size:0.85rem;" id="breakdownEmpType">Time-based</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Period Selection -->
    <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:1rem; margin-bottom:1.5rem;">
      <div>
        <label style="color:#ccc; display:block; margin-bottom:0.25rem;">Period Start</label>
        <input type="date" id="breakdownPeriodStart" name="breakdownPeriodStart_nocache" autocomplete="off" data-lpignore="true"
               style="width:100%; padding:0.5rem; border-radius:6px; border:1px solid #275b48; background:#0d1b0e; color:#fff;">
      </div>
      <div>
        <label style="color:#ccc; display:block; margin-bottom:0.25rem;">Period End</label>
        <input type="date" id="breakdownPeriodEnd" name="breakdownPeriodEnd_nocache" autocomplete="off" data-lpignore="true"
               style="width:100%; padding:0.5rem; border-radius:6px; border:1px solid #275b48; background:#0d1b0e; color:#fff;">
      </div>
      <div style="display:flex; align-items:flex-end;">
        <button type="button" onclick="window.loadBreakdownAttendance()" class="actions-btn" style="background:#0dcaf0; color:#0d1b0e; width:100%;">
          Load Attendance
        </button>
      </div>
    </div>

    <!-- Attendance Table -->
    <div style="margin-bottom:1.5rem;">
      <h4 style="color:#fff; margin-bottom:0.5rem;">Attendance Records</h4>
      <div style="max-height:300px; overflow-y:auto; border:1px solid #275b48; border-radius:6px;">
        <table class="table" style="margin:0;">
          <thead style="position:sticky; top:0; background:#1a2a1a;">
            <tr>
              <th style="padding:0.5rem; text-align:left; color:#fff; border-bottom:1px solid #275b48;">Date</th>
              <th style="padding:0.5rem; text-align:center; color:#fff; border-bottom:1px solid #275b48;">Time In</th>
              <th style="padding:0.5rem; text-align:center; color:#fff; border-bottom:1px solid #275b48;">Time Out</th>
              <th style="padding:0.5rem; text-align:center; color:#fff; border-bottom:1px solid #275b48;">Regular Hrs</th>
              <th style="padding:0.5rem; text-align:center; color:#28a745; border-bottom:1px solid #275b48;">Rate</th>
              <th style="padding:0.5rem; text-align:center; color:#fff; border-bottom:1px solid #275b48;">OT Hrs</th>
              <th style="padding:0.5rem; text-align:center; color:#fff; border-bottom:1px solid #275b48;">OT Pay</th>
              <th style="padding:0.5rem; text-align:center; color:#fff; border-bottom:1px solid #275b48;">Double Pay</th>
              <th style="padding:0.5rem; text-align:center; color:#fff; border-bottom:1px solid #275b48;">Status</th>
            </tr>
          </thead>
          <tbody id="breakdownAttendanceBody">
            <tr>
              <td colspan="9" style="text-align:center; padding:2rem; color:#888;">
                Select a period and click "Load Attendance" to view records
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Summary Section -->
    <div style="display:grid; grid-template-columns:1fr 1fr; gap:1.5rem; margin-bottom:1.5rem;">
      <!-- Earnings Summary -->
      <div style="background:#1a2a1a; border-radius:8px; padding:1rem; border:1px solid #275b48;">
        <h4 style="color:#0dcaf0; margin:0 0 0.75rem 0; font-size:0.875rem; text-transform:uppercase;">Earnings</h4>
        <div style="display:flex; flex-direction:column; gap:0.5rem;">
          <div style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Regular Pay:</span>
            <span style="color:#fff; font-weight:500;" id="breakdownRegPay">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Overtime Pay:</span>
            <span style="color:#fff; font-weight:500;" id="breakdownOTPay">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Allowance: <span style="color:#17a2b8; font-size:0.7rem;">(De Minimis)</span></span>
            <span style="color:#fff; font-weight:500;" id="breakdownAllowance">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Double Pay:</span>
            <span style="color:#fff; font-weight:500;" id="breakdownDoublePay">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Perfect Attendance: <span style="color:#17a2b8; font-size:0.7rem;">(De Minimis)</span></span>
            <span style="color:#28a745; font-weight:500;" id="breakdownPerfectAttendance">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Leave Conversion: <span style="color:#17a2b8; font-size:0.7rem;">(De Minimis)</span></span>
            <span style="color:#28a745; font-weight:500;" id="breakdownLeaveConversion">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between; border-top:1px solid #275b48; padding-top:0.5rem; margin-top:0.25rem;">
            <span style="color:#fff; font-weight:600;">Total Earnings:</span>
            <span style="color:#28a745; font-weight:700;" id="breakdownTotalEarnings">‚Ç±0.00</span>
          </div>
        </div>
      </div>
      
      <!-- Deductions Summary -->
      <div style="background:#1a2a1a; border-radius:8px; padding:1rem; border:1px solid #275b48;">
        <h4 style="color:#dc3545; margin:0 0 0.75rem 0; font-size:0.875rem; text-transform:uppercase;">Deductions</h4>
        <div style="display:flex; flex-direction:column; gap:0.5rem;">
          <!-- Exclude All Deductions Toggle -->
          <div id="excludeDeductionsSection" style="margin-bottom:0.5rem; padding:0.75rem; background:linear-gradient(135deg, rgba(108,117,125,0.2) 0%, rgba(108,117,125,0.05) 100%); border-radius:8px; border:1px solid rgba(108,117,125,0.4);">
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <div style="display:flex; align-items:center; gap:0.5rem;">
                <span style="font-size:1rem;">üö´</span>
                <span style="color:#adb5bd; font-weight:600; font-size:0.85rem;">Exclude from All Deductions</span>
              </div>
              <div style="display:flex; gap:0.5rem;">
                <button type="button" id="btnIncludeDeductions" onclick="window.toggleExcludeAllDeductions(false)" style="padding:0.4rem 0.75rem; border:2px solid #28a745; background:#28a74520; color:#28a745; border-radius:6px; font-weight:600; font-size:0.75rem; cursor:pointer; transition:all 0.2s;">
                  ‚úì INCLUDE
                </button>
                <button type="button" id="btnExcludeDeductions" onclick="window.toggleExcludeAllDeductions(true)" style="padding:0.4rem 0.75rem; border:2px solid #6c757d; background:transparent; color:#6c757d; border-radius:6px; font-weight:600; font-size:0.75rem; cursor:pointer; transition:all 0.2s;">
                  ‚úó EXCLUDE
                </button>
              </div>
            </div>
            <input type="hidden" id="excludeAllDeductions" value="false">
            <div id="excludeDeductionsNote" style="display:none; margin-top:0.5rem; padding:0.4rem; background:rgba(253,126,20,0.15); border:1px solid rgba(253,126,20,0.4); border-radius:4px;">
              <span style="color:#fd7e14; font-size:0.75rem;">‚ö†Ô∏è All government contributions will be set to ‚Ç±0.00</span>
            </div>
          </div>
          <!-- Government Contributions -->
          <div id="breakdownGovtHeader" style="color:#888; font-size:0.75rem; text-transform:uppercase; margin-bottom:0.25rem;">Government Contributions</div>
          <div id="breakdownSSSRow" class="print-hide-employee-contrib" style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">SSS (Employee):</span>
            <span style="color:#fff; font-weight:500;" id="breakdownSSS">‚Ç±0.00</span>
          </div>
          <div id="breakdownPhilHealthRow" class="print-hide-employee-contrib" style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">PhilHealth (Employee):</span>
            <span style="color:#fff; font-weight:500;" id="breakdownPhilHealth">‚Ç±0.00</span>
          </div>
          <div id="breakdownPagIbigRow" class="print-hide-employee-contrib" style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Pag-IBIG (Employee):</span>
            <span style="color:#fff; font-weight:500;" id="breakdownPagIbig">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Withholding Tax:</span>
            <span style="color:#fff; font-weight:500;" id="breakdownWithholdingTax">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between; border-top:1px dashed #275b48; padding-top:0.25rem; margin-top:0.25rem;">
            <span style="color:#ccc; font-size:0.8rem;">Gov't Contributions Total:</span>
            <span style="color:#dc3545; font-weight:500; font-size:0.8rem;" id="breakdownGovtTotal">‚Ç±0.00</span>
          </div>
          
          <!-- Salary Advance Deduction Section - Deducted based on when advance was given -->
          <div id="salaryAdvanceSection" style="margin:0.75rem 0; padding:0.75rem; background:linear-gradient(135deg, rgba(253,126,20,0.15) 0%, rgba(253,126,20,0.05) 100%); border-radius:8px; border:1px solid rgba(253,126,20,0.4);">
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <div style="display:flex; align-items:center; gap:0.5rem;">
                <span style="font-size:1.1rem;">üí∞</span>
                <span style="color:#fd7e14; font-weight:600; font-size:0.9rem;">Salary Advance</span>
              </div>
              <div style="display:flex; align-items:center; gap:0.5rem;">
                <button type="button" onclick="window.printSalaryAdvances()" id="btnPrintAdvances" style="display:none; padding:0.25rem 0.5rem; border:1px solid #0dcaf0; background:transparent; color:#0dcaf0; border-radius:4px; font-size:0.7rem; cursor:pointer;" title="Print Salary Advances">
                  üñ®Ô∏è Print
                </button>
                <span style="color:#fd7e14; font-weight:700; font-size:1.1rem;" id="advanceOutstandingLabel">Loading...</span>
              </div>
            </div>
            <!-- Salary Advances Table -->
            <div id="advancesSummaryTable" style="display:none; margin-top:0.5rem; max-height:150px; overflow-y:auto;">
              <table style="width:100%; border-collapse:collapse; font-size:0.75rem;">
                <thead>
                  <tr style="background:rgba(253,126,20,0.2);">
                    <th style="padding:0.35rem; text-align:left; color:#fd7e14; border-bottom:1px solid rgba(253,126,20,0.3);">Date</th>
                    <th style="padding:0.35rem; text-align:right; color:#fd7e14; border-bottom:1px solid rgba(253,126,20,0.3);">Amount</th>
                  </tr>
                </thead>
                <tbody id="advancesSummaryBody">
                </tbody>
              </table>
            </div>
            <div id="advanceDeductionControls" style="display:none; margin-top:0.75rem;">
              <div style="display:flex; gap:0.5rem; margin-bottom:0.5rem;">
                <button type="button" id="btnDeductAdvance" onclick="setAdvanceDeduction(true)" style="flex:1; padding:0.5rem; border:2px solid #28a745; background:#28a74520; color:#28a745; border-radius:6px; font-weight:600; font-size:0.8rem; cursor:pointer; transition:all 0.2s;">
                  ‚úì DEDUCT -‚Ç±<span id="deductBtnAmount">0.00</span>
                </button>
                <button type="button" id="btnSkipAdvance" onclick="setAdvanceDeduction(false)" style="flex:1; padding:0.5rem; border:2px solid #6c757d; background:transparent; color:#6c757d; border-radius:6px; font-weight:600; font-size:0.8rem; cursor:pointer; transition:all 0.2s;">
                  ‚úó SKIP
                </button>
              </div>
              <input type="hidden" id="skipAdvanceDeduction" value="false">
              <div id="advanceWarning" style="display:none; padding:0.5rem; background:rgba(220,53,69,0.15); border:1px solid rgba(220,53,69,0.4); border-radius:6px;">
                <span style="color:#dc3545; font-size:0.75rem;">‚ö†Ô∏è Advance exceeds earnings. Net pay will be negative.</span>
              </div>
            </div>
            <div id="noAdvanceMessage" style="display:none; text-align:center; padding:0.5rem;">
              <span style="color:#28a745; font-size:0.85rem;">‚úì No advances this period</span>
            </div>
          </div>
          
          <div style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Salary Advance Deduction:</span>
            <span style="color:#fd7e14; font-weight:500;" id="breakdownAdvanceDeduction">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Other Deductions:</span>
            <span style="color:#fff; font-weight:500;" id="breakdownOtherDed">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between; border-top:1px solid #275b48; padding-top:0.5rem; margin-top:0.25rem;">
            <span style="color:#fff; font-weight:600;">Total Deductions:</span>
            <span style="color:#dc3545; font-weight:700;" id="breakdownTotalDeductions">‚Ç±0.00</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Net Calculation -->
    <div style="background:#0d1b0e; border-radius:8px; padding:1rem; border:1px solid #275b48; margin-bottom:1rem;">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <span style="color:#fff; font-size:1.1rem; font-weight:600;">Net Pay:</span>
        <span style="color:#0dcaf0; font-size:1.25rem; font-weight:700;" id="breakdownNetPay">‚Ç±0.00</span>
      </div>
      <div style="display:flex; justify-content:center; margin-top:0.5rem;">
        <span style="color:#888; font-size:0.8rem;" id="breakdownNetFormula">Earnings - Deductions = Net Pay</span>
      </div>
    </div>

    <!-- Modal Footer -->
    <div style="display:flex; justify-content:flex-end; gap:0.75rem; padding-top:1rem; border-top:1px solid #275b48;">
      <button type="button" onclick="window.closeDailyBreakdownModal()" class="actions-btn" style="background:#6c757d;">Cancel</button>
      <button type="button" onclick="window.saveBreakdownRecord()" class="actions-btn" style="background:#198754;">Save Breakdown</button>
    </div>
  </div>
</div>

<!-- View Breakdown Modal (Read-only) -->
<div id="viewBreakdownModal" class="modal">
  <div class="modal-content" role="dialog" aria-modal="true" style="max-width:1200px; max-height:90vh; overflow-y:auto;">
    <span class="close" onclick="window.closeViewBreakdownModal()">&times;</span>
    
    <!-- Company Header (Print Only) - Shows FIRST on print -->
    <div id="printCompanyHeader" style="display:none; text-align:center; margin-bottom:1rem; padding-bottom:0.75rem; border-bottom:2px solid #275b48;">
      <img src="../assets/msvi-logo.png" alt="MSVI Logo" style="height:60px; margin-bottom:0.5rem;" onerror="this.style.display='none'">
      <h2 style="margin:0; font-size:14pt; color:#000; font-weight:700;">MORPH SAGRADO VENTURES INC.</h2>
      <p style="margin:0.25rem 0 0; font-size:9pt; color:#555;">Payslip</p>
    </div>

    <div class="modal-header" style="display:flex; justify-content:space-between; align-items:center;">
      <h3 style="margin:0; color:#fff;">Payslip Details</h3>
    </div>

    <!-- Employee Info Header with Rate Info -->
    <div id="viewBreakdownEmployeeHeader" style="display:flex; flex-wrap:wrap; background:#1a2a1a; border-radius:8px; padding:1rem; margin-bottom:1rem; border:1px solid #275b48; gap:1rem;">
      <!-- Left: Employee Info -->
      <div style="display:flex; align-items:center; gap:1rem; flex:1; min-width:200px;">
        <div style="width:50px; height:50px; background:#0dcaf0; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:700; font-size:1.2rem; color:#0d1b0e;" id="viewBreakdownEmpInitials">JD</div>
        <div>
          <h4 style="margin:0; color:#fff;" id="viewBreakdownEmpName">John Doe</h4>
          <div style="color:#0dcaf0; font-size:0.8rem; font-weight:500;" id="viewBreakdownEmpId">EMP-0001</div>
          <div style="color:#ccc; font-size:0.875rem;" id="viewBreakdownEmpDept">Department</div>
        </div>
      </div>
      
      <!-- Center: Rate Info Cards -->
      <div style="display:flex; flex-wrap:wrap; gap:0.5rem; align-items:center; flex:2;">
        <div style="background:#0d1b0e; padding:0.4rem 0.75rem; border-radius:6px; border:1px solid #275b48; text-align:center;">
          <div style="color:#888; font-size:0.65rem; text-transform:uppercase;">Daily Rate</div>
          <div style="color:#0dcaf0; font-weight:600; font-size:0.9rem;" id="viewBreakdownDailyRate">‚Ç±0.00</div>
        </div>
        <div style="background:#0d1b0e; padding:0.4rem 0.75rem; border-radius:6px; border:1px solid #275b48; text-align:center;">
          <div style="color:#888; font-size:0.65rem; text-transform:uppercase;">Hourly Rate</div>
          <div style="color:#0dcaf0; font-weight:600; font-size:0.9rem;" id="viewBreakdownHourlyRate">‚Ç±0.00</div>
        </div>
        <div style="background:#0d1b0e; padding:0.4rem 0.75rem; border-radius:6px; border:1px solid #275b48; text-align:center;">
          <div style="color:#888; font-size:0.65rem; text-transform:uppercase;">OT Rate</div>
          <div style="color:#0dcaf0; font-weight:600; font-size:0.9rem;" id="viewBreakdownOTRate">‚Ç±0.00</div>
        </div>
        <div style="background:#0d1b0e; padding:0.4rem 0.75rem; border-radius:6px; border:1px solid #275b48; text-align:center;">
          <div style="color:#888; font-size:0.65rem; text-transform:uppercase;">Work Days</div>
          <div style="color:#0dcaf0; font-weight:600; font-size:0.9rem;" id="viewBreakdownWorkDays">0</div>
        </div>
        <div style="background:#0d1b0e; padding:0.4rem 0.75rem; border-radius:6px; border:1px solid #275b48; text-align:center;">
          <div style="color:#888; font-size:0.65rem; text-transform:uppercase;">Type</div>
          <div style="color:#0dcaf0; font-weight:600; font-size:0.9rem;" id="viewBreakdownEmpType">-</div>
        </div>
      </div>
      
      <!-- Right: Period -->
      <div style="text-align:right; min-width:150px;">
        <span style="color:#ccc; font-size:0.75rem;">Period:</span>
        <div style="color:#0dcaf0; font-weight:600;" id="viewBreakdownPeriod">--</div>
      </div>
    </div>

    <!-- Attendance Table (Read-only) - FIRST -->
    <div style="margin-bottom:1.5rem;">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:0.5rem;">
        <h4 style="color:#fff; margin:0;">Attendance Records</h4>
        <button class="btn-primary no-print" style="background:linear-gradient(135deg, #0dcaf0 0%, #0aa2c0 100%); padding:0.4rem 0.75rem; font-size:0.85rem;" onclick="window.refreshBreakdownModal?.()" title="Refresh Attendance">üîÑ Refresh</button>
      </div>
      <div style="max-height:250px; overflow-y:auto; border:1px solid #275b48; border-radius:6px;">
        <table class="table breakdown-attendance-table" style="margin:0; border-collapse:collapse;">
          <thead style="position:sticky; top:0; background:#1a2a1a;">
            <tr>
              <th style="padding:0.5rem; text-align:left; color:#fff; border:1px solid #275b48;">Date</th>
              <th style="padding:0.5rem; text-align:center; color:#fff; border:1px solid #275b48;">Time In</th>
              <th style="padding:0.5rem; text-align:center; color:#fff; border:1px solid #275b48;">Time Out</th>
              <th style="padding:0.5rem; text-align:center; color:#fff; border:1px solid #275b48;">Regular Hrs</th>
              <th style="padding:0.5rem; text-align:center; color:#28a745; border:1px solid #275b48;">Rate</th>
              <th style="padding:0.5rem; text-align:center; color:#fff; border:1px solid #275b48;">OT Hrs</th>
              <th style="padding:0.5rem; text-align:center; color:#fff; border:1px solid #275b48;">OT Pay</th>
              <th style="padding:0.5rem; text-align:center; color:#fff; border:1px solid #275b48;">Double Pay</th>
              <th style="padding:0.5rem; text-align:center; color:#fff; border:1px solid #275b48;">Status</th>
            </tr>
          </thead>
          <tbody id="viewBreakdownAttendanceBody">
            <tr>
              <td colspan="9" style="text-align:center; padding:2rem; color:#888;">
                No attendance records found
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Summary Section (Read-only) - AFTER ATTENDANCE TABLE -->
    <div id="payrollSummarySection" style="display:grid; grid-template-columns:1fr 1fr; gap:1.5rem; margin-bottom:1.5rem;">
      <!-- Earnings Summary -->
      <div style="background:#1a2a1a; border-radius:8px; padding:1rem; border:1px solid #275b48;">
        <h4 style="color:#0dcaf0; margin:0 0 0.75rem 0; font-size:0.875rem; text-transform:uppercase;">Earnings</h4>
        <div style="display:flex; flex-direction:column; gap:0.5rem;">
          <div style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Regular Pay:</span>
            <span style="color:#fff; font-weight:500;" id="viewBreakdownRegPay">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Overtime Pay:</span>
            <span style="color:#fff; font-weight:500;" id="viewBreakdownOTPay">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Allowance: <span style="color:#17a2b8; font-size:0.7rem;">(De Minimis)</span></span>
            <span style="color:#fff; font-weight:500;" id="viewBreakdownAllowance">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Double Pay:</span>
            <span style="color:#fff; font-weight:500;" id="viewBreakdownDoublePay">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Perfect Attendance: <span style="color:#17a2b8; font-size:0.7rem;">(De Minimis)</span></span>
            <span style="color:#28a745; font-weight:500;" id="viewBreakdownPerfectAttendance">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Leave Conversion: <span style="color:#17a2b8; font-size:0.7rem;">(De Minimis)</span></span>
            <span style="color:#28a745; font-weight:500;" id="viewBreakdownLeaveConversion">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between; border-top:1px solid #275b48; padding-top:0.5rem; margin-top:0.25rem;">
            <span style="color:#fff; font-weight:600;">Total Earnings:</span>
            <span style="color:#28a745; font-weight:700;" id="viewBreakdownTotalEarnings">‚Ç±0.00</span>
          </div>
        </div>
      </div>
      
      <!-- Deductions Summary -->
      <div style="background:#1a2a1a; border-radius:8px; padding:1rem; border:1px solid #275b48;">
        <h4 style="color:#dc3545; margin:0 0 0.75rem 0; font-size:0.875rem; text-transform:uppercase;">Deductions</h4>
        <div style="display:flex; flex-direction:column; gap:0.5rem;">
          <!-- Government Contributions -->
          <div id="viewBreakdownGovtHeader" style="color:#888; font-size:0.75rem; text-transform:uppercase; margin-bottom:0.25rem;">Government Contributions</div>
          <div id="viewBreakdownSSSRow" class="print-hide-employee-contrib" style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">SSS (Employee):</span>
            <span style="color:#fff; font-weight:500;" id="viewBreakdownSSS">‚Ç±0.00</span>
          </div>
          <div id="viewBreakdownPhilHealthRow" class="print-hide-employee-contrib" style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">PhilHealth (Employee):</span>
            <span style="color:#fff; font-weight:500;" id="viewBreakdownPhilHealth">‚Ç±0.00</span>
          </div>
          <div id="viewBreakdownPagIbigRow" class="print-hide-employee-contrib" style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Pag-IBIG (Employee):</span>
            <span style="color:#fff; font-weight:500;" id="viewBreakdownPagIbig">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Withholding Tax:</span>
            <span style="color:#fff; font-weight:500;" id="viewBreakdownWithholdingTax">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between; border-top:1px dashed #275b48; padding-top:0.25rem; margin-top:0.25rem;">
            <span style="color:#ccc; font-size:0.8rem;">Gov't Contributions Total:</span>
            <span style="color:#dc3545; font-weight:500; font-size:0.8rem;" id="viewBreakdownGovtTotal">‚Ç±0.00</span>
          </div>
          
          <!-- Other Deductions -->
          <div style="color:#888; font-size:0.75rem; text-transform:uppercase; margin-top:0.5rem;">Other Deductions</div>
          <div style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Salary Advance Deduction:</span>
            <span style="color:#ffc107; font-weight:500;" id="viewBreakdownAdvanceDeduction">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span style="color:#ccc;">Other Deductions:</span>
            <span style="color:#fff; font-weight:500;" id="viewBreakdownOtherDed">‚Ç±0.00</span>
          </div>
          <div style="display:flex; justify-content:space-between; border-top:1px solid #275b48; padding-top:0.5rem; margin-top:0.25rem;">
            <span style="color:#fff; font-weight:600;">Total Deductions:</span>
            <span style="color:#dc3545; font-weight:700;" id="viewBreakdownTotalDeductions">‚Ç±0.00</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Net Calculation - AT THE BOTTOM -->
    <div id="netPaySection" style="background:#0d1b0e; border-radius:8px; padding:1rem; border:1px solid #275b48; margin-bottom:1rem;">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <span style="color:#fff; font-size:1.1rem; font-weight:600;">Net Pay:</span>
        <span style="color:#0dcaf0; font-size:1.25rem; font-weight:700;" id="viewBreakdownNetPay">‚Ç±0.00</span>
      </div>
      <div style="display:flex; justify-content:center; margin-top:0.5rem;">
        <span style="color:#888; font-size:0.8rem;" id="viewBreakdownNetFormula">Earnings - Deductions = Net Pay</span>
      </div>
    </div>

    <!-- Signature Section (Print Only) - Will be positioned at bottom of page -->
    <div id="signatureSection" style="display:none;">
      <!-- Date Received - centered between Checked By and Approved By -->
      <div style="display:flex; justify-content:space-between; gap:1rem; padding:0 0.5rem; margin-bottom:5rem;">
        <div style="flex:1;"></div>
        <div style="flex:2; text-align:center;">
          <div style="border-bottom:1px solid #000; height:60px; margin-bottom:0.25rem; width:60%; margin-left:auto; margin-right:auto;"></div>
          <p style="margin:0; font-size:9pt; color:#000;"><strong>Date Received</strong></p>
        </div>
        <div style="flex:1;"></div>
      </div>
      <!-- All signatures in one row -->
      <div style="display:flex; justify-content:space-between; gap:1rem; padding:0 0.5rem;">
        <!-- Prepared By -->
        <div style="flex:1; text-align:center;">
          <div style="border-bottom:1px solid #000; height:100px; margin-bottom:0.25rem;"></div>
          <p style="margin:0; font-size:9pt; color:#000;"><strong>PREPARED BY:</strong></p>
          <p style="margin:0.15rem 0 0; font-size:9pt; color:#000;">Veloso, Lovely Ann N.</p>
          <p style="margin:0; font-size:8pt; color:#555;">EMP-60322</p>
          <p style="margin:0; font-size:8pt; color:#555;">Administrative Department</p>
        </div>
        <!-- Checked By -->
        <div style="flex:1; text-align:center;">
          <div style="border-bottom:1px solid #000; height:100px; margin-bottom:0.25rem;"></div>
          <p style="margin:0; font-size:9pt; color:#000;"><strong>CHECKED BY:</strong></p>
          <p style="margin:0.15rem 0 0; font-size:9pt; color:#000;">Nimia Faildon</p>
          <p style="margin:0; font-size:8pt; color:#555;">MIFU Deployed Officer</p>
          <p style="margin:0; font-size:8pt; color:#555;">Finance Department</p>
        </div>
        <!-- Approved By -->
        <div style="flex:1; text-align:center;">
          <div style="border-bottom:1px solid #000; height:100px; margin-bottom:0.25rem;"></div>
          <p style="margin:0; font-size:9pt; color:#000;"><strong>APPROVED BY:</strong></p>
          <p style="margin:0.15rem 0 0; font-size:9pt; color:#000;">Celine B. Martinez</p>
          <p style="margin:0; font-size:8pt; color:#555;">Director of MIFU</p>
          <p style="margin:0; font-size:8pt; color:#555;">Finance Department</p>
        </div>
        <!-- Received By -->
        <div style="flex:1; text-align:center;">
          <div style="border-bottom:1px solid #000; height:100px; margin-bottom:0.25rem;"></div>
          <p style="margin:0; font-size:9pt; color:#000;"><strong>RECEIVED BY:</strong></p>
          <p style="margin:0.15rem 0 0; font-size:9pt; color:#000;" id="printEmployeeName">Employee Name</p>
          <p style="margin:0; font-size:8pt; color:#555;" id="printEmployeeId">EMP-0001</p>
          <p style="margin:0; font-size:8pt; color:#555;" id="printEmployeePosition">Department</p>
        </div>
      </div>
    </div>

    <!-- Modal Footer -->
    <div style="display:flex; justify-content:flex-end; gap:0.75rem; padding-top:1rem; border-top:1px solid #275b48;" class="no-print">
      <button type="button" onclick="window.printPayrollBreakdown()" class="actions-btn" style="background:#0dcaf0; color:#0d1b0e;">üñ®Ô∏è Print</button>
      <button type="button" onclick="window.closeViewBreakdownModal()" class="actions-btn" style="background:#6c757d;">Close</button>
    </div>
  </div>
</div>

<!-- Print Styles for Payroll Breakdown -->
<style id="payrollPrintStyles">
  @media print {
    /* Page setup - tighter margins for more space */
    @page {
      size: A4 portrait;
      margin: 8mm 8mm 8mm 8mm;
    }
    
    /* Show company header on print - large and readable */
    body.printing-payroll #printCompanyHeader {
      display: block !important;
      border-bottom: 1px solid #000 !important;
      margin-bottom: 4px !important;
      padding-bottom: 2px !important;
    }
    
    body.printing-payroll #printCompanyHeader h2 {
      color: #000 !important;
      font-size: 14pt !important;
      margin: 0 !important;
    }
    
    body.printing-payroll #printCompanyHeader p {
      color: #333 !important;
      font-size: 10pt !important;
      margin: 0 !important;
    }
    
    /* Hide everything except the print content */
    body.printing-payroll {
      margin: 0 !important;
      padding: 0 !important;
      background: #fff !important;
    }
    
    body.printing-payroll * {
      visibility: hidden;
    }
    
    body.printing-payroll #viewBreakdownModal,
    body.printing-payroll #viewBreakdownModal * {
      visibility: visible !important;
    }
    
    /* Exception: Hide SSS/PhilHealth/Pag-IBIG employee contribution rows even in modal */
    body.printing-payroll #viewBreakdownModal .print-hide-employee-contrib,
    body.printing-payroll #viewBreakdownModal .print-hide-employee-contrib * {
      visibility: hidden !important;
      display: none !important;
    }
    
    body.printing-payroll #viewBreakdownModal {
      position: absolute !important;
      left: 0 !important;
      top: 0 !important;
      width: 100% !important;
      height: auto !important;
      background: #fff !important;
      overflow: visible !important;
      display: block !important;
      padding: 0 !important;
      margin: 0 !important;
      z-index: 99999 !important;
    }
    
    body.printing-payroll #viewBreakdownModal .modal-content {
      max-width: 100% !important;
      width: 100% !important;
      max-height: none !important;
      overflow: visible !important;
      box-shadow: none !important;
      border: none !important;
      background: #fff !important;
      padding: 0 !important;
      margin: 0 !important;
      border-radius: 0 !important;
    }
    
    /* Hide close button and footer */
    body.printing-payroll #viewBreakdownModal .close,
    body.printing-payroll #viewBreakdownModal .no-print {
      display: none !important;
    }
    
    /* Modal header - large readable */
    body.printing-payroll #viewBreakdownModal .modal-header {
      background: #fff !important;
      border-bottom: 1px solid #000 !important;
      padding: 2px 0 !important;
      margin-bottom: 4px !important;
      display: block !important;
      text-align: center !important;
    }
    
    body.printing-payroll #viewBreakdownModal .modal-header h3 {
      color: #000 !important;
      font-size: 13pt !important;
      text-align: center !important;
      margin: 0 !important;
    }
    
    /* Employee header section - large readable */
    body.printing-payroll #viewBreakdownEmployeeHeader {
      display: flex !important;
      flex-wrap: wrap !important;
      background: #f5f5f5 !important;
      border: 1px solid #333 !important;
      border-radius: 0 !important;
      padding: 4px !important;
      margin-bottom: 4px !important;
      gap: 4px !important;
    }
    
    body.printing-payroll #viewBreakdownEmployeeHeader * {
      color: #000 !important;
    }
    
    /* Employee initials circle */
    body.printing-payroll #viewBreakdownEmpInitials {
      background: #333 !important;
      color: #fff !important;
      width: 28px !important;
      height: 28px !important;
      font-size: 8pt !important;
    }
    
    /* Employee name and info */
    body.printing-payroll #viewBreakdownEmpName {
      font-size: 12pt !important;
    }
    
    body.printing-payroll #viewBreakdownEmpDept,
    body.printing-payroll #viewBreakdownEmpId {
      font-size: 10pt !important;
    }
    
    /* Rate info cards */
    body.printing-payroll #viewBreakdownEmployeeHeader div[style*="background:#0d1b0e"] {
      background: #f0f0f0 !important;
      border: 1px solid #999 !important;
      padding: 2px 4px !important;
    }
    
    body.printing-payroll #viewBreakdownEmployeeHeader div[style*="color:#888"] {
      color: #555 !important;
      font-size: 9pt !important;
    }
    
    body.printing-payroll #viewBreakdownEmployeeHeader div[style*="color:#0dcaf0"] {
      color: #000 !important;
      font-size: 10pt !important;
      font-weight: bold !important;
    }
    
    /* Attendance section header */
    body.printing-payroll #viewBreakdownModal h4 {
      color: #000 !important;
      font-size: 11pt !important;
      margin: 0 0 2px 0 !important;
      padding: 0 !important;
      background: transparent !important;
    }
    
    /* Remove max-height from attendance table container */
    body.printing-payroll #viewBreakdownModal div[style*="max-height"] {
      max-height: none !important;
      overflow: visible !important;
      border: none !important;
    }
    
    /* Table styles - large readable font */
    body.printing-payroll #viewBreakdownModal table.table {
      width: 100% !important;
      border-collapse: collapse !important;
      font-size: 10pt !important;
      margin-bottom: 4px !important;
    }
    
    body.printing-payroll #viewBreakdownModal table.table thead {
      background: #e8e8e8 !important;
    }
    
    body.printing-payroll #viewBreakdownModal table.table th {
      background: #e0e0e0 !important;
      color: #000 !important;
      font-weight: bold !important;
      border: 1px solid #333 !important;
      padding: 1px 2px !important;
      font-size: 10pt !important;
      text-align: center !important;
    }
    
    body.printing-payroll #viewBreakdownModal table.table td {
      background: #fff !important;
      color: #000 !important;
      border: 1px solid #333 !important;
      padding: 1px 2px !important;
      font-size: 10pt !important;
    }
    
    body.printing-payroll #viewBreakdownModal table.table tbody tr:nth-child(even) td {
      background: #f9f9f9 !important;
    }
    
    /* Summary grid - Earnings and Deductions side by side */
    body.printing-payroll #viewBreakdownModal div[style*="grid-template-columns:1fr 1fr"] {
      display: table !important;
      width: 100% !important;
      border-collapse: separate !important;
      border-spacing: 4px 0 !important;
      margin-bottom: 4px !important;
    }
    
    body.printing-payroll #viewBreakdownModal div[style*="grid-template-columns:1fr 1fr"] > div {
      display: table-cell !important;
      width: 50% !important;
      vertical-align: top !important;
      background: #f5f5f5 !important;
      border: 1px solid #333 !important;
      padding: 4px !important;
      border-radius: 0 !important;
    }
    
    /* Earnings and Deductions headers */
    body.printing-payroll #viewBreakdownModal div[style*="grid-template-columns:1fr 1fr"] h4 {
      font-size: 14pt !important;
      font-weight: bold !important;
      border-bottom: 1px solid #333 !important;
      padding-bottom: 3px !important;
      margin-bottom: 4px !important;
    }
    
    /* Summary row items - larger font for seniors */
    body.printing-payroll #viewBreakdownModal div[style*="grid-template-columns:1fr 1fr"] div[style*="display:flex"][style*="justify-content:space-between"] {
      display: flex !important;
      justify-content: space-between !important;
      padding: 2px 0 !important;
      font-size: 12pt !important;
    }
    
    body.printing-payroll #viewBreakdownModal div[style*="grid-template-columns:1fr 1fr"] span {
      color: #000 !important;
      font-size: 12pt !important;
    }
    
    /* Total rows in earnings/deductions */
    body.printing-payroll #viewBreakdownModal div[style*="border-top:1px solid #275b48"] {
      border-top: 1px solid #333 !important;
      padding-top: 2px !important;
      margin-top: 2px !important;
    }
    
    /* Earnings total color */
    body.printing-payroll #viewBreakdownTotalEarnings {
      color: #006600 !important;
    }
    
    /* Deductions total color */
    body.printing-payroll #viewBreakdownTotalDeductions {
      color: #990000 !important;
    }
    
    /* Net Pay section */
    body.printing-payroll #viewBreakdownModal div[style*="background:#0d1b0e"][style*="margin-bottom:1rem"] {
      background: #e8f4e8 !important;
      border: 1px solid #333 !important;
      padding: 4px !important;
      margin-bottom: 0 !important;
      border-radius: 0 !important;
    }
    
    body.printing-payroll #viewBreakdownNetPay {
      color: #000 !important;
      font-size: 18pt !important;
      font-weight: bold !important;
    }
    
    body.printing-payroll #viewBreakdownNetFormula {
      color: #555 !important;
      font-size: 11pt !important;
    }
    
    /* Government Contributions and Other Deductions sub-headers - smaller font */
    body.printing-payroll #viewBreakdownModal div[style*="color:#888"][style*="text-transform:uppercase"] {
      font-size: 8pt !important;
      color: #555 !important;
    }
    
    /* Status text colors */
    body.printing-payroll #viewBreakdownModal span[style*="color:#16a34a"],
    body.printing-payroll #viewBreakdownModal span[style*="color:#28a745"] {
      color: #006600 !important;
    }
    
    body.printing-payroll #viewBreakdownModal span[style*="color:#dc3545"],
    body.printing-payroll #viewBreakdownModal span[style*="color:#dc2626"] {
      color: #990000 !important;
    }
    
    body.printing-payroll #viewBreakdownModal span[style*="color:#ca8a04"] {
      color: #996600 !important;
    }
    
    body.printing-payroll #viewBreakdownModal span[style*="color:#2563eb"] {
      color: #000099 !important;
    }
    
    body.printing-payroll #viewBreakdownModal span[style*="color:#ea580c"] {
      color: #cc4400 !important;
    }
    
    /* Hide time PM line breaks for cleaner print */
    body.printing-payroll #viewBreakdownModal td br + span {
      display: block !important;
      font-size: 5pt !important;
      color: #666 !important;
    }
    
    /* Summary section - no page breaks, everything on one page */
    body.printing-payroll #payrollSummarySection {
      page-break-before: auto !important;
      break-before: auto !important;
      page-break-after: avoid !important;
      break-after: avoid !important;
      margin-bottom: 4px !important;
    }
    
    /* Net Pay section stays on same page */
    body.printing-payroll #netPaySection {
      page-break-before: avoid !important;
      break-before: avoid !important;
      page-break-after: avoid !important;
      break-after: avoid !important;
      background: #e8f4e8 !important;
      border: 1px solid #333 !important;
      padding: 4px !important;
      margin-bottom: 0 !important;
      border-radius: 0 !important;
    }
    
    /* Attendance table - readable font for seniors */
    body.printing-payroll .breakdown-attendance-table {
      border-collapse: collapse !important;
      width: 100% !important;
      font-size: 9pt !important;
    }
    
    body.printing-payroll .breakdown-attendance-table th,
    body.printing-payroll .breakdown-attendance-table td {
      border: 1px solid #333 !important;
      padding: 2px 3px !important;
      font-size: 9pt !important;
    }
    
    /* Make everything more compact for single page */
    body.printing-payroll #viewBreakdownEmployeeHeader {
      padding: 4px !important;
      margin-bottom: 4px !important;
      gap: 4px !important;
    }
    
    body.printing-payroll #viewBreakdownEmployeeHeader div[style*="background:#0d1b0e"] {
      padding: 2px 4px !important;
    }
    
    body.printing-payroll #viewBreakdownModal div[style*="grid-template-columns:1fr 1fr"] > div {
      padding: 4px !important;
    }
    
    /* Reduce attendance section height */
    body.printing-payroll #viewBreakdownModal div[style*="max-height"] {
      max-height: none !important;
      overflow: visible !important;
    }
    
    /* Avoid all page breaks */
    body.printing-payroll #viewBreakdownModal * {
      page-break-inside: avoid !important;
      break-inside: avoid !important;
    }
    
    /* Make modal content flex to push signature to bottom */
    body.printing-payroll #viewBreakdownModal .modal-content {
      display: flex !important;
      flex-direction: column !important;
      min-height: 100vh !important;
      box-sizing: border-box !important;
    }
    
    /* Modal body grows to fill space */
    body.printing-payroll #viewBreakdownModal .modal-body {
      flex: 1 1 auto !important;
    }
    
    /* Signature Section - Fixed at bottom of page */
    body.printing-payroll #signatureSection {
      display: block !important;
      position: fixed !important;
      bottom: 10mm !important;
      left: 8mm !important;
      right: 8mm !important;
      padding-top: 0 !important;
      border-top: none !important;
      background: #fff !important;
      page-break-inside: avoid !important;
      break-inside: avoid !important;
    }
    
    body.printing-payroll #signatureSection div[style*="display:flex"] {
      display: flex !important;
    }
    
    body.printing-payroll #signatureSection p {
      color: #000 !important;
      font-size: 10pt !important;
    }
    
    body.printing-payroll #signatureSection p strong {
      font-size: 11pt !important;
    }
    
    /* Signature lines */
    body.printing-payroll #signatureSection div[style*="border-bottom"] {
      height: 25px !important;
      margin-bottom: 2px !important;
    }
    
    /* Hide other modals during breakdown print */
    body.printing-payroll #deleteBreakdownModal,
    body.printing-payroll #addBreakdownModal,
    body.printing-payroll #editBreakdownModal,
    body.printing-payroll .modal:not(#viewBreakdownModal) {
      display: none !important;
      visibility: hidden !important;
    }
    
    /* Only print when modal is actually open */
    body.printing-payroll #viewBreakdownModal:not(.open):not([style*="display: block"]):not([style*="display:block"]) {
      display: none !important;
    }
    
    /* Hide SSS, PhilHealth, Pag-IBIG employee contribution rows in print */
    body.printing-payroll .print-hide-employee-contrib,
    body.printing-payroll #viewBreakdownSSSRow,
    body.printing-payroll #viewBreakdownPhilHealthRow,
    body.printing-payroll #viewBreakdownPagIbigRow,
    body.printing-payroll #breakdownSSSRow,
    body.printing-payroll #breakdownPhilHealthRow,
    body.printing-payroll #breakdownPagIbigRow {
      display: none !important;
      visibility: hidden !important;
      height: 0 !important;
      overflow: hidden !important;
      margin: 0 !important;
      padding: 0 !important;
    }
    
    /* Also hide the children of these rows */
    body.printing-payroll .print-hide-employee-contrib *,
    body.printing-payroll #viewBreakdownSSSRow *,
    body.printing-payroll #viewBreakdownPhilHealthRow *,
    body.printing-payroll #viewBreakdownPagIbigRow *,
    body.printing-payroll #breakdownSSSRow *,
    body.printing-payroll #breakdownPhilHealthRow *,
    body.printing-payroll #breakdownPagIbigRow * {
      display: none !important;
      visibility: hidden !important;
    }
    
    /* Remove margin from Government Contributions header in print since employee rows are hidden */
    body.printing-payroll #viewBreakdownGovtHeader,
    body.printing-payroll #breakdownGovtHeader {
      margin-bottom: 0 !important;
    }
    
    /* Net Pay formula - centered and aligned properly */
    body.printing-payroll #viewBreakdownNetFormula {
      display: block !important;
      text-align: center !important;
      font-size: 11pt !important;
      color: #333 !important;
      margin-top: 4px !important;
    }
    
    body.printing-payroll #netPaySection {
      text-align: center !important;
    }
    
    body.printing-payroll #netPaySection > div:first-child {
      justify-content: center !important;
      gap: 1rem !important;
    }
  }
</style>

<!-- Delete Breakdown Modal -->
<div id="deleteBreakdownModal" class="modal">
  <div class="modal-content" role="dialog" aria-modal="true" style="max-width:400px;">
    <span class="close" onclick="window.closeDeleteBreakdownModal()">&times;</span>
    <h3>Delete Breakdown</h3>
    <p style="margin-bottom:0.75rem;">Are you sure you want to delete this breakdown record?<br>
      <strong id="deleteBreakdownInfo"></strong><br>
      <span style="color:#c53045;">This action cannot be undone.</span>
    </p>
    <input type="hidden" id="deleteBreakdownId" value="" />
    <div style="display:flex; justify-content:flex-end; gap:0.5rem;">
      <button class="actions-btn" onclick="window.closeDeleteBreakdownModal()">Cancel</button>
      <button class="actions-btn delete-btn" onclick="window.confirmDeleteBreakdown()">Delete</button>
    </div>
  </div>
</div>
